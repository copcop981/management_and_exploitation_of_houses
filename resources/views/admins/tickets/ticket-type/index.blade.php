@extends('admins.layouts.master')

@section('title')
    Quản lý bán vé - Trung tâm quản lý và khai thác nhà Đà Nẵng
@endsection

@section('style')
<style>
    table {
        min-width: max-content;
    }


    th {
        box-shadow: 0 2px 2px -1px rgba(0, 0, 0, 0.4);
        background: #333;
        position: sticky;
        top: 0;
        z-index: 999;
    }

    .table-wrapper {
        max-height: 450px;
        overflow: scroll;
    }
</style>
@endsection

@section('content')
<!--# Page header -->
<div class="page-header page-header-light">
    <div class="page-header-content header-elements-lg-inline">
        <div class="page-title d-flex"></div>
        <div class="header-elements d-none">
            <div class="d-flex justify-content-center">
                <a href="#" class="btn btn-link btn-float text-body"><i class="icon-bars-alt text-primary"></i><span>Thống kê</span></a>
                <a href="#" class="btn btn-link btn-float text-body"><i class="icon-calculator text-primary"></i> <span>Hóa đơn</span></a>
                <a href="#" class="btn btn-link btn-float text-body"><i class="icon-calendar5 text-primary"></i> <span>Lịch trình</span></a>
            </div>
        </div>
    </div>
    <div class="breadcrumb-line breadcrumb-line-light header-elements-lg-inline">
        <div class="d-flex">
            <div class="breadcrumb">
                <a href="" class="breadcrumb-item"><i class="icon-home2 mr-2"></i> Trang chủ</a>
                <a href="" class="breadcrumb-item">Vé xe</a>
                <span href="" class="breadcrumb-item active">Loại vé</span>
            </div>
            <a href="#" class="header-elements-toggle text-body d-lg-none"><i class="icon-more"></i></a>
        </div>

    </div>
</div>
<!--# /page header -->

<div class="content">
    <div class="card mb-4">
        <div class="container mb-2">
            <div class="mt-2 d-flex justify-content-end">
                <button type="button" class="btn btn-info btn-sm" id="btn_create">
                    <i class="fa-solid fa-plus mr-1"></i>
                    Tạo mới
                </button>
            </div>

            <div class="mt-2">
                <div class="p-1 pl-2 bg-primary text-light" style="border-radius: 5px 5px 0 0;">
                    <span>Danh sách loại vé</span>
                </div>
                <div class="mt-2 d-flex justify-content-between">
                    <div>
                        <select name="" class="custom-select custom-select-sm" id="row">
                            <option value="5">5 hàng</option>
                            <option value="10">10 hàng</option>
                            <option value="15">15 hàng</option>
                            <option value="20">20 hàng</option>
                        </select>
                    </div>
            
                    <div class="d-flex align-items-center">
                        <span style="width: 80px;">Tìm kiếm:</span>
                        <div style="display: flex; position: relative;">
                            <input type="text" name="" id="input_search" class="form-control form-control-sm">
                            <a href="" class="d-none" id="btn_refresh_input_search">
                                <i class="fa-solid fa-xmark" style="position: absolute;
                                    top: 50%;
                                    transform: translateY(-50%);
                                    right: 0;
                                    padding: 10px;
                                    font-size: 16px;
                                    cursor: pointer;
                                    color: #868686;">
                                </i>
                            </a>
                        </div>
                        <button type="button" class="btn btn-success btn-sm" id="btn_search" style="margin-left: 0.5rem !important;">
                            <i class="fa-solid fa-magnifying-glass mr-1"></i>
                            Tìm kiếm
                        </button>
                    </div>
                </div>
                <div id="list_ticket_type_table">
                    @include('admins.tickets.ticket-type.pagination')
                </div>
            </div>

            {{-- Modal Tạo mới --}}
            <div class="modal fade" id="modal_create" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel">Tạo mới loại vé</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body pt-0">
                        <form action="" id="form_create">
                            <div class="mt-2">
                                <div>
                                    <label for="" class="col-form-label-sm m-0">Tên loại vé</label>
                                    <input type="text" class="form-control form-control-sm" id="ticket_type_name_create">
                                    <small class="text-danger d-none"></small>
                                </div>

                                <div class="mt-2">
                                    <div class="row">
                                        <div class="col-8">
                                            <label for="" class="col-form-label-sm m-0">Giá sau thuế <small class="text-danger">(Chú ý cập nhật giá trước thuế)</small></label>
                                        </div>
                                        <div class="col-4"></div>
                                    </div>
                                    <div class="row">
                                        <div class="col-8">
                                            <input type="text" class="form-control form-control-sm" id="amount_after_vat_create">
                                        </div>
                                        <div class="col-4 pl-0">
                                            <button type="button" class="btn btn-outline-primary btn-sm" id="btn_cal_amount_before_vat_create" style="width: 100% !important;">Tính giá trước thuế</button>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-2">
                                    <div class="row">
                                        <div class="col-4">
                                            <label for="" class="col-form-label-sm m-0">VAT</label>
                                        </div>
                                        <div class="col-8">
                                            <label for="" class="col-form-label-sm m-0">Giá trước thuế</label>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-4">
                                            <select name="" id="vat_create" class="custom-select custom-select-sm">
                                                <option value="">-- Chọn thuế --</option>
                                                <option value="kct">Không chịu thuế</option>
                                                <option value="0">0%</option>
                                                <option value="2">2%</option>
                                                <option value="5">5%</option>
                                                <option value="7">7%</option>
                                                <option value="8">8%</option>
                                                <option value="10">10%</option>
                                                <option value="30">30%</option>
                                            </select>
                                        </div>
                                        <div class="col-8 pl-0">
                                            <input type="text" class="form-control form-control-sm" id="amount_before_vat_create" disabled>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-2">
                                    <div class="row">
                                        <div class="col-6">
                                            <label for="" class="col-form-label-sm m-0">Mẫu số</label>
                                        </div>
                                        <div class="col-6">
                                            <label for="" class="col-form-label-sm m-0">Ký hiệu</label>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-6 pr-1">
                                            <input type="text" class="form-control form-control-sm" id="pattern_create" value="5/001">
                                        </div>
                                        <div class="col-6 pl-1">
                                            <input type="text" class="form-control form-control-sm text-uppercase" id="serial_create" value="c22gaa">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-outline-secondary btn-sm" data-dismiss="modal">Đóng</button>
                      <button type="button" class="btn btn-primary btn-sm" id="btn_store" style="margin-left: 0.5rem !important;">Lưu</button>
                    </div>
                  </div>
                </div>
            </div>

            {{-- Modal Chỉnh sửa --}}
            <div class="modal fade" id="modal_edit" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel">Chỉnh sửa loại vé</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body pt-0">
                        <form action="" id="form_edit">
                            <div class="mt-2">
                                <div>
                                    <label for="" class="col-form-label-sm m-0">Tên loại vé</label>
                                    <input type="text" class="form-control form-control-sm" id="ticket_type_name_edit">
                                    <small class="text-danger d-none"></small>
                                </div>

                                <div class="mt-2">
                                    <div class="row">
                                        <div class="col-8">
                                            <label for="" class="col-form-label-sm m-0">Giá sau thuế <small class="text-danger">(Chú ý cập nhật giá trước thuế)</small></label>
                                        </div>
                                        <div class="col-4"></div>
                                    </div>
                                    <div class="row">
                                        <div class="col-8">
                                            <input type="text" class="form-control form-control-sm" id="amount_after_vat_edit">
                                        </div>
                                        <div class="col-4 pl-0">
                                            <button type="button" class="btn btn-outline-success btn-sm" id="btn_cal_amount_before_vat_edit" style="width: 100% !important;">Tính giá trước thuế</button>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-2">
                                    <div class="row">
                                        <div class="col-4">
                                            <label for="" class="col-form-label-sm m-0">VAT</label>
                                        </div>
                                        <div class="col-8">
                                            <label for="" class="col-form-label-sm m-0">Giá trước thuế</label>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-4">
                                            <select name="" id="vat_edit" class="custom-select custom-select-sm">
                                                <option value="">-- Chọn thuế --</option>
                                                <option value="kct">Không chịu thuế</option>
                                                <option value="0">0%</option>
                                                <option value="2">2%</option>
                                                <option value="5">5%</option>
                                                <option value="7">7%</option>
                                                <option value="8">8%</option>
                                                <option value="10">10%</option>
                                                <option value="30">30%</option>
                                            </select>
                                        </div>
                                        <div class="col-8 pl-0">
                                            <input type="text" class="form-control form-control-sm" id="amount_before_vat_edit" disabled>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-2">
                                    <div class="row">
                                        <div class="col-6">
                                            <label for="" class="col-form-label-sm m-0">Mẫu số</label>
                                        </div>
                                        <div class="col-6">
                                            <label for="" class="col-form-label-sm m-0">Ký hiệu</label>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-6 pr-1">
                                            <input type="text" class="form-control form-control-sm" id="pattern_edit">
                                        </div>
                                        <div class="col-6 pl-1">
                                            <input type="text" class="form-control form-control-sm text-uppercase" id="serial_edit">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-outline-secondary btn-sm" data-dismiss="modal">Đóng</button>
                      <button type="button" class="btn btn-success btn-sm" id="btn_update" style="margin-left: 0.5rem !important;">Cập nhật</button>
                    </div>
                  </div>
                </div>
            </div>

            {{-- Modal Xác nhận Xóa --}}
            <div class="modal fade" id="modal_delete" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel">Xác nhận</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                        <span>Xác nhận xóa loại vé này?</span>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-outline-secondary btn-sm" data-dismiss="modal">Đóng</button>
                      <button type="button" class="btn btn-danger btn-sm" id="btn_destroy" style="margin-left: 0.5rem !important;">Xóa</button>
                    </div>
                  </div>
                </div>
            </div>
        </div>
    </div>
</div>
@endsection

@section('script')
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="{{ asset('./js/index.js') }}"></script>
<script>
$(document).ready(function() {
    let search = $('#input_search');
    function currencyInput(value) {
        return value.replace(/(?!\.)\D/g, "").replace(/(?<=\..*)\./g, "").replace(/(?<=\.\d\d).*/g, "").replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    function calAmountBeforeVat(amountAfterVat, vat, amountBeforeVat) {
        let v = '1.';
        let vatCal = 0;
        let result;
        if(vat.val() == 'kct' || vat.val() == '0')
            return amountAfterVat.val();
        amountAfterVat = parseFloat(amountAfterVat.val().split(',').join(''));
        if(vat.val().length == 2) {
            let first = vat.val().charAt(0);
            vatCal = parseFloat(v + first);
        } else if(vat.val().length == 1)
            vatCal = parseFloat(v + '0' + vat.val());
        let amountBeforeVatAfterCal = amountAfterVat / vatCal;
        result = amountBeforeVatAfterCal.toFixed(2);
        return result;
    }

    function validateTicketType(typeName, amountAfterVat, vat, amountBeforeVat, pattern, serial, btn) {
        let validateTypeName = validateField(typeName, btn, 'input change keyup paste', 'Vui lòng nhập Tên loại vé');
        let validateAmountAfterVat = validateField(amountAfterVat, btn, 'input change keyup paste', 'Vui lòng nhập Giá sau thuế');
        let validateVat = validateField(vat, btn, 'input change', 'Vui lòng chọn Thuế');
        let validateAmountBeforeVat = validateField(amountBeforeVat, btn, 'input change keyup paste', 'Vui lòng nhập Giá trước thuế');
        let validatePattern = validateField(pattern, btn, 'input change keyup paste', 'Vui lòng nhập Mẫu số');
        let validateSerial = validateField(serial, btn, 'input change keyup paste', 'Vui lòng nhập Ký hiệu');
        if(!validateTypeName || !validateAmountAfterVat || !validateVat || 
            !validateAmountBeforeVat || !validatePattern || !validateSerial) return false;
        return true;
    }

    function validateVat(amountAfterVat, vat, btn) {
        let validateAmountAfterVat = validateField(amountAfterVat, btn, 'input change keyup paste', 'Vui lòng nhập Giá sau thuế');
        let validateVat = validateField(vat, btn, 'input change', 'Vui lòng chọn Thuế');
        if(!validateAmountAfterVat || !validateVat) return false;
        return true;
    }

    $(document).off('change', '#vat_create').on('change', '#vat_create', function() {
        $('#amount_before_vat_create').val('');
    });

    $(document).off('change keyup input paste', '#amount_after_vat_create').on('change keyup input paste', '#amount_after_vat_create', function() {
        let vat = $('#vat_create');
        let amountBeforeVat = $('#amount_before_vat_create');
        vat.val('');
        amountBeforeVat.val('');
        $(this).val(currencyInput($(this).val()));
    });

    $(document).off('change keyup input paste', '#amount_after_vat_edit').on('change keyup input paste', '#amount_after_vat_edit', function() {
        let vat = $('#vat_edit');
        let amountBeforeVat = $('#amount_before_vat_edit');
        vat.val('');
        amountBeforeVat.val('');
        $(this).val(currencyInput($(this).val()));
    });

    $(document).off('change keyup input paste', '#amount_before_vat_create, #amount_before_vat_edit').on('change keyup input paste', '#amount_before_vat_create, #amount_before_vat_edit', function() {
        $(this).val(currencyInput($(this).val()));
    });

    $(document).prop('disabled', false).off('click', '#btn_cal_amount_before_vat_create').on('click', '#btn_cal_amount_before_vat_create', function(e) {
        e.preventDefault();
        $(this).prop('disabled', true);
        if(!validateVat('#amount_after_vat_create', '#vat_create', $(this))) return;

        let amountAfterVat = $('#amount_after_vat_create');
        let vat = $('#vat_create');
        let amountBeforeVat = $('#amount_before_vat_create');
        amountBeforeVat.val(calAmountBeforeVat(amountAfterVat, vat, amountBeforeVat)).trigger('change');
        $(this).prop('disabled', false);
    });

    $(document).prop('disabled', false).off('click', '#btn_cal_amount_before_vat_edit').on('click', '#btn_cal_amount_before_vat_edit', function(e) {
        e.preventDefault();
        $(this).prop('disabled', true);
        if(!validateVat('#amount_after_vat_edit', '#vat_edit', $(this))) return;

        let amountAfterVat = $('#amount_after_vat_edit');
        let vat = $('#vat_edit');
        let amountBeforeVat = $('#amount_before_vat_edit');
        amountBeforeVat.val(calAmountBeforeVat(amountAfterVat, vat, amountBeforeVat)).trigger('change');
        $(this).prop('disabled', false);
    });

    $(document).off('change', 'input[name="ids"]').on('change', 'input[name="ids"]', function() {
        let id = $(this).val();
        let url = "{{ route('ticket-type.update.status', ':id') }}";
        url = url.replace(':id', id);
        let status;
        if($(this).prop('checked')) status = 1;
        else status = 0;
        $.ajax({
            type: "PATCH",
            url: url,
            data: {
                status: status,
                _token: "{{ csrf_token() }}",
            },
            success: function (res) {
                alert(res.message);
            }
        });
    });

    $(document).off('click', '#btn_create').on('click', '#btn_create', function(e) {
        e.preventDefault();
        $('#modal_create').modal('show');

        $(document).prop('disabled', false).off('click', '#btn_store').on('click', '#btn_store', function(e) {
            e.preventDefault();
            $(this).prop('disabled', true);
            if(!validateTicketType('#ticket_type_name_create', '#amount_after_vat_create', '#vat_create', '#amount_before_vat_create', '#pattern_create', '#serial_create', $(this))) 
                return;
            let ticketTypeName = $('#ticket_type_name_create');
            let amountAfterVat = $('#amount_after_vat_create');
            let vat = $('#vat_create');
            let amountBeforeVat = $('#amount_before_vat_create');
            let pattern = $('#pattern_create');
            let serial = $('#serial_create');
            $.ajax({
                type: "POST",
                url: "{{ route('ticket-type.store') }}",
                data: {
                    type: ticketTypeName.val(),
                    price: amountAfterVat.val().split(',').join(''),
                    vat: vat.val(),
                    priceBeforeVat: amountBeforeVat.val().split(',').join(''),
                    pattern: pattern.val(),
                    serial: serial.val(),
                    _token: "{{ csrf_token() }}",
                },
                success: function (res) {
                    if(res.status == 200) {
                        alert(res.message);
                        $('#btn_store').prop('disabled', false);
                        $('#modal_create').modal('hide');
                        $('#row').val('5').trigger('change');
                    }
                    if(res.status == 400) {
                        alert(res.message);
                        $('#btn_store').prop('disabled', false);
                    }
                    if(res.status == 401) {
                        $('#ticket_type_name_create').addClass('border border-danger');
                        $('#ticket_type_name_create + small.text-danger').removeClass('d-none').html(res.message);
                        $('#btn_store').prop('disabled', false);
                    }
                }
            });
        });

        $(document).off('hidden.bs.modal', '#modal_create').on('hidden.bs.modal', '#modal_create', function() {
            $('#form_create').find(':input:not("#pattern_create, #serial_create")').val('');
            $('#form_create').find('.border.border-danger').removeClass('border border-danger');
            $('#form_create').find('.text-danger').addClass('d-none');
        });
    });

    $(document).off('click', '#btn_edit').on('click', '#btn_edit', function(e) {
        e.preventDefault();
        $('#modal_edit').modal('show');
        let ticketTypeName = $('#ticket_type_name_edit');
        let amountAfterVat = $('#amount_after_vat_edit');
        let vat = $('#vat_edit');
        let amountBeforeVat = $('#amount_before_vat_edit');
        let pattern = $('#pattern_edit');
        let serial = $('#serial_edit');
        let id = $(this).val();
        let url = "{{ route('ticket-type.edit', ':id') }}";
        url = url.replace(':id', id);
        $.ajax({
            type: "GET",
            url: url,
            success: function (res) {
                if(res.ticketType != null) {
                    ticketTypeName.val(res.ticketType.type);
                    amountAfterVat.val(res.ticketType.price).trigger('change');
                    vat.val(res.ticketType.vat);
                    amountBeforeVat.val(res.ticketType.price_before_vat).trigger('change');
                    pattern.val(res.ticketType.pattern);
                    serial.val(res.ticketType.serial);
                }
            }
        });

        $(document).prop('disabled', false).off('click', '#btn_update').on('click', '#btn_update', function(e) {
            e.preventDefault();
            $(this).prop('disabled', true);
            if(!validateTicketType('#ticket_type_name_edit', '#amount_after_vat_edit', '#vat_edit', '#amount_before_vat_edit', '#pattern_edit', '#serial_edit', $(this))) 
                return;
            url = "{{ route('ticket-type.update', ':id') }}";
            url = url.replace(':id', id);
            $.ajax({
                type: "PATCH",
                url: url,
                data: {
                    type: ticketTypeName.val(),
                    price: amountAfterVat.val().split(',').join(''),
                    vat: vat.val(),
                    priceBeforeVat: amountBeforeVat.val().split(',').join(''),
                    pattern: pattern.val(),
                    serial: serial.val(),
                    _token: "{{ csrf_token() }}",
                },
                success: function (res) {
                    if(res.status == 200) {
                        alert(res.message);
                        $('#btn_update').prop('disabled', false);
                        $('#modal_edit').modal('hide');
                        $('#row').val('5').trigger('change');
                    }
                    if(res.status == 400) {
                        alert(res.message);
                        $('#btn_update').prop('disabled', false);
                    }
                    if(res.status == 401) {
                        $('#ticket_type_name_edit').addClass('border border-danger');
                        $('#ticket_type_name_edit + small.text-danger').removeClass('d-none').html(res.message);
                        $('#btn_update').prop('disabled', false);
                    }
                }
            });
        });

        $(document).off('hidden.bs.modal', '#modal_edit').on('hidden.bs.modal', '#modal_edit', function() {
            $('#form_edit').find(':input').val('');
            $('#form_edit').find('.border.border-danger').removeClass('border border-danger');
            $('#form_edit').find('.text-danger').addClass('d-none');
        });
    });

    $(document).off('click', '#btn_delete').on('click', '#btn_delete', function(e) {
        e.preventDefault();
        let id = $(this).val();
        let url = "{{ route('ticket-type.destroy', ':id') }}";
        url = url.replace(':id', id);
        $('#modal_delete').modal('show');

        $(document).prop('disabled', false).off('click', '#btn_destroy').on('click', '#btn_destroy', function(e) {
            e.preventDefault();
            $(this).prop('disabled', true);
            $.ajax({
                type: "DELETE",
                url: url,
                data: { _token: "{{ csrf_token() }}", },
                success: function (res) {
                    if(res.status == 200) {
                        alert(res.message);
                        $('#btn_destroy').prop('disabled', false);
                        $('#modal_delete').modal('hide');
                        $('#row').val('5').trigger('change');
                    }

                    if(res.status == 400) {
                        alert(res.message);
                        $('#btn_destroy').prop('disabled', false);
                    }
                }
            });
        });
    });

    $(document).off('click', '#btn_refresh_input_search').on('click', '#btn_refresh_input_search', function(e) {
        e.preventDefault();
        $('#input_search').val('');
        $(this).removeClass('d-inline');
        $(this).addClass('d-none');
        $('#input_search').trigger('focus');
    });

    $(document).off('input', '#input_search').on('input', '#input_search', function() {
        if($(this).val() != '') {
            $('#btn_refresh_input_search').removeClass('d-none');
            $('#btn_refresh_input_search').addClass('d-inline');
        } else {
            $('#btn_refresh_input_search').removeClass('d-inline');
            $('#btn_refresh_input_search').addClass('d-none');
        }
    });

    $(document).off('click', '.pagination a').on('click', '.pagination a', function(e) {
        e.preventDefault();
        let page = $(this).attr('href').split('?page=')[1];
        let numRow = $('#row').val();
        $.ajax({
            url: "/admins/ticket/ticket-type/fetch?page=" + page,
            data: {
                search: search.val(),
                numRow: numRow > 0 ? numRow : 0,
            },
            success: function (res) {
                $('#list_ticket_type_table').html(res);
                $('#row').val(numRow);
                // if(search == '')
                //     $('#row').val('5').change();
            }
        });
    });

    $(document).off('change', '#row').on('change', '#row', function() {
        if($(this).val() == '5') {
            search.val('');
            $('#btn_refresh_input_search').removeClass('d-inline');
            $('#btn_refresh_input_search').addClass('d-none');
        }
        let numRow = $(this).val();
        $.ajax({
            url: "{{ route('get.row.ticket-type') }}",
            data: {
                search: search.val(),
                numRow: numRow,
            },
            success: function (res) {
                $('#list_ticket_type_table').html(res);
                $('#row').val(numRow);
            }
        });
    });

    $(document).prop('disabled', false).off('click', '#btn_search').on('click', '#btn_search', function (e) {
        e.preventDefault();
        $(this).prop('disabled', true);
        $.ajax({
            type: "GET",
            url: "{{ route('ticket-type.search') }}",
            data: { search: search.val() },
            success: function (res) {
                $('#btn_search').prop('disabled', false);
                $('#list_ticket_type_table').html(res);
                $('#row').val('15');
                // if(search.val() == '') 
                //     $('#row').val('5').change();
            }
        });
    });
});
</script>
@endsection
