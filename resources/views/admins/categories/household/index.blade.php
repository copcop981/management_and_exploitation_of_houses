@extends('admins.layouts.master')

@section('title')
    Danh sách hộ dân
@endsection

@section('style')
<style>
    fieldset.scheduler-border {
        border: 1px groove #ddd !important;
        padding: 0 1.4em .2em 1.4em !important;
        margin: 0 !important;
        -webkit-box-shadow: 0px 0px 0px 0px #000;
                box-shadow: 0px 0px 0px 0px #000;
    }

    legend.scheduler-border {
        /* font-size: 1.2em !important; */
        /* font-weight: bold !important; */
        /* text-align: left !important; */
        width: auto;
        padding: 0 10px;
        border-bottom: none;
    }
</style>
@endsection

@section('content')
    <!--# Page header -->
<div class="page-header page-header-light">
    <div class="page-header-content header-elements-lg-inline">
        <div class="page-title d-flex"></div>
        <div class="header-elements d-none">
            <div class="d-flex justify-content-center">
                <a href="#" class="btn btn-link btn-float text-body"><i class="icon-bars-alt text-primary"></i><span>Thống kê</span></a>
                <a href="#" class="btn btn-link btn-float text-body"><i class="icon-calculator text-primary"></i> <span>Hóa đơn</span></a>
                <a href="#" class="btn btn-link btn-float text-body"><i class="icon-calendar5 text-primary"></i> <span>Lịch trình</span></a>
            </div>
        </div>
    </div>
    <div class="breadcrumb-line breadcrumb-line-light header-elements-lg-inline">
        <div class="d-flex">
            <div class="breadcrumb">
                <a href="index.html" class="breadcrumb-item"><i class="icon-home2 mr-2"></i> Trang chủ</a>
                <a href="alpaca_advanced.html" class="breadcrumb-item">Danh sách hộ dân</a>
                <!-- <span class="breadcrumb-item active">Trang 1</span> -->
            </div>
            <a href="#" class="header-elements-toggle text-body d-lg-none"><i class="icon-more"></i></a>
        </div>
    </div>
</div>
<!--# /page header -->

<div class="content">
    <div class="card mb-4">
        <div class="container mb-2">
            <div class="mt-2">
                <fieldset class="scheduler-border">
                    <legend class="scheduler-border">Tìm kiếm</legend>
                    <form action="" method="" id="form_search">
                        <div class="row">
                            <div class="col-6">
                                <div class="form-group">
                                    <div class="row align-items-center">
                                        <div class="col-4">
                                            <label for="apartment" class="float-right col-form-label">Tên chung cư</label>
                                        </div>
                                        <div class="col-8">
                                            <input list="list_apartment" name="apartment" id="apartment" class="form-control form-control-sm">
                                            <datalist id="list_apartment">
                                            </datalist>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="form-group">
                                    <div class="row align-items-center">
                                        <div class="col-4">
                                            <label for="status" class="float-right col-form-label">Trạng thái</label>
                                        </div>
                                        <div class="col-8">
                                            <input list="list_status" name="status" id="status" class="form-control form-control-sm">
                                            <datalist id="list_status">
                                            </datalist>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                <div class="form-group">
                                    <div class="row align-items-center">
                                        <div class="col-4">
                                            <label for="address" class="float-right col-form-label">Địa chỉ</label>
                                        </div>
                                        <div class="col-8">
                                            <input type="text" id="address" class="form-control form-control-sm">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="form-group">
                                    <div class="row align-items-center">
                                        <div class="col-4">
                                            <label for="contract_signing_date" class="float-right col-form-label">Ngày ký HĐ</label>
                                        </div>
                                        <div class="col-8">
                                            <input type="date" id="contract_signing_date" class="form-control form-control-sm">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                <div class="form-group">
                                    <div class="row align-items-center">
                                        <div class="col-4">
                                            <label for="room" class="float-right col-form-label">Căn hộ</label>
                                        </div>
                                        <div class="col-8">
                                            <input list="list_room" name="room" id="room" class="form-control form-control-sm">
                                            <datalist id="list_room">
                                            </datalist>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="form-group">
                                    <div class="row align-items-center">
                                        <div class="col-4">
                                            <label for="price" class="float-right col-form-label">Đơn giá</label>
                                        </div>
                                        <div class="col-8">
                                            <input type="number" id="price" class="form-control form-control-sm">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                <div class="form-group">
                                    <div class="row align-items-center">
                                        <div class="col-4">
                                            <label for="resident_object" class="float-right col-form-label">Đối tượng</label>
                                        </div>
                                        <div class="col-8">
                                            <input list="list_resident_object" name="resident_object" id="resident_object" class="form-control form-control-sm">
                                            <datalist id="list_resident_object">
                                            </datalist>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="form-group">
                                    <div class="row align-items-center">
                                        <div class="col-4">
                                            <label for="exemption" class="float-right col-form-label">Miễn giảm</label>
                                        </div>
                                        <div class="col-8">
                                            <input type="number" name="exemption" id="exemption" class="form-control form-control-sm">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                {{-- <div class="form-group">
                                    <div class="row align-items-center">
                                        <div class="col-4">
                                            <label for="" class="float-right">Tên chung cư</label>
                                        </div>
                                        <div class="col-8">
                                            <select name="" id="" class="form-control form-control-sm">
                                                <option value="0">--- Chọn chung cư ---</option>
                                            </select>
                                        </div>
                                    </div>
                                </div> --}}
                            </div>
                            <div class="col-6">
                                <div class="form-group">
                                    <div class="row align-items-center">
                                        <div class="col-4">
                                            
                                        </div>
                                        <div class="col-8">
                                            <button type="button" class="btn btn-success btn-sm" id="search_invoice_btn">
                                                <i class="fa-solid fa-magnifying-glass mr-1"></i>
                                                Tìm kiếm
                                            </button>
                                            <button type="button" class="btn btn-warning btn-sm" id="refresh_input_search_btn">
                                                <i class="fa-solid fa-rotate mr-1"></i>
                                                Làm mới
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </fieldset>
            </div>
            
            <div class="mt-3">
                <div class="d-flex justify-content-between">
                    <div>
                        <select name="" id="row" class="form-control custom-select">
                            <option value="5">5 hàng</option>
                            <option value="10">10 hàng</option>
                            <option value="15">15 hàng</option>
                            <option value="20">20 hàng</option>
                        </select>
                    </div>
                    <div>
                        <button type="button" class="btn btn-warning btn-sm">
                            <i class="fa-solid fa-circle-exclamation mr-1"></i>
                            Thanh lý
                        </button>
                        <button type="button" class="btn btn-warning btn-sm">
                            <i class="fa-solid fa-right-left mr-1"></i>
                            Chuyển đổi
                        </button>
                        <button type="button" class="btn btn-info btn-sm" id="create_household_btn">
                            <i class="fa-solid fa-plus mr-1"></i>
                            Tạo mới
                        </button>
                        {{-- <button type="button" class="btn btn-success btn-sm" id="edit_household_btn">
                            <i class="fa-solid fa-pen mr-1"></i>
                            Chỉnh sửa
                        </button> --}}
                        <button type="button" class="btn btn-danger btn-sm" id="delete_many_household_btn" hidden>
                            <i class="fa-solid fa-trash mr-1"></i>
                            Xóa hàng loạt
                        </button>
                    </div>
                </div>
            </div>

            <div class="mt-3">
                <i class="fa-solid fa-paper-plane" style="color: #868686;"></i>
                <span class="text-uppercase" style="color: #868686; font-weight: 500;">Danh sách hộ dân</span>
            </div>

            <div id="list_qlv_table">
                @include('admins.categories.household.pagination')
            </div>

            {{-- Modal Tạo mới --}}
            <div class="modal fade" id="modal_create_household" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Tạo mới</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form action="" id="form_create_household">
                                <input type="number" id="room_id">
                                <div class="row">
                                    <div class="col-3">
                                        <label for="household_fullname_create" class="col-form-label float-right">Tên khách hàng</label>
                                    </div>
                                    <div class="col-9">
                                        <input type="text" name="household_fullname_create" id="household_fullname_create" class="form-control form-control-sm">
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_apartment_create" class="col-form-label float-right">Tên chung cư</label>
                                    </div>
                                    <div class="col-9">
                                        <input list="list_apartment_create" name="household_apartment_create" id="household_apartment_create" class="form-control form-control-sm">
                                        <datalist id="list_apartment_create">
                                            <option></option>
                                        </datalist>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_block_create" class="col-form-label float-right">Nhà</label>
                                    </div>
                                    <div class="col-8">
                                        <input list="list_block_create" name="household_block_create" id="household_block_create" class="form-control form-control-sm">
                                        <datalist id="list_block_create">
                                            <option></option>
                                        </datalist>
                                    </div>
                                    <div class="col-1 p-0">
                                        <button type="button" class="btn btn-outline-info btn-sm" id="create_block_btn">
                                            <i class="fa-solid fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_floor_create" class="col-form-label float-right">Tầng</label>
                                    </div>
                                    <div class="col-8">
                                        <input list="list_floor_create" name="household_floor_create" id="household_floor_create" class="form-control form-control-sm">
                                        <datalist id="list_floor_create">
                                            <option></option>
                                        </datalist>
                                    </div>
                                    <div class="col-1 p-0">
                                        <button type="button" class="btn btn-outline-info btn-sm" id="create_floor_btn">
                                            <i class="fa-solid fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_room_create" class="col-form-label float-right">Căn hộ</label>
                                    </div>
                                    <div class="col-8">
                                        <input list="list_room_create" name="household_room_create" id="household_room_create" class="form-control form-control-sm">
                                        <datalist id="list_room_create">
                                            <option></option>
                                        </datalist>
                                    </div>
                                    <div class="col-1 p-0">
                                        <button type="button" class="btn btn-outline-info btn-sm" id="create_room_btn">
                                            <i class="fa-solid fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_resident_object_create" class="col-form-label float-right">Đối tượng</label>
                                    </div>
                                    <div class="col-8">
                                        <input list="list_resident_object_create" name="household_resident_object_create" id="household_resident_object_create" class="form-control form-control-sm">
                                        <datalist id="list_resident_object_create">
                                            <option></option>
                                        </datalist>
                                    </div>
                                    <div class="col-1 p-0">
                                        <button type="button" class="btn btn-outline-info btn-sm" id="create_resident_object_btn">
                                            <i class="fa-solid fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_price_create" class="col-form-label float-right">Đơn giá</label>
                                    </div>
                                    <div class="col-9">
                                        <input type="number" name="household_price_create" id="household_price_create" class="form-control form-control-sm">
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_exemption_create" class="col-form-label float-right">Miễn giảm</label>
                                    </div>
                                    <div class="col-9">
                                        <input list="list_exemption_create" name="household_exemption_create" id="household_exemption_create" class="form-control form-control-sm">
                                        <datalist id="list_exemption_create">
                                            <option></option>
                                        </datalist>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_contract_signing_date_create" class="col-form-label float-right">Ngày ký HĐ</label>
                                    </div>
                                    <div class="col-9">
                                        <input type="date" name="household_contract_signing_date_create" id="household_contract_signing_date_create" class="form-control form-control-sm">
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-outline-secondary btn-sm" data-dismiss="modal">Đóng</button>
                            <button type="button" class="btn btn-warning btn-sm" id="refresh_save_household_btn" style="margin-left: 0.5rem !important;">Làm mới</button>
                            <button type="button" class="btn btn-primary btn-sm" id="save_household_btn" style="margin-left: 0.5rem !important;">Lưu</button>
                        </div>
                    </div>
                </div>
            </div>

            {{-- Modal Tạo mới Block --}}
            <div class="modal fade" id="modal_create_block" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Tạo mới Nhà</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form action="" id="form_create_block">
                                <div class="row">
                                    <div class="col-3">
                                        <label for="block_name_create" class="col-form-label float-right">Tên Nhà</label>
                                    </div>
                                    <div class="col-9">
                                        <input type="text" name="" id="block_name_create" class="form-control form-control-sm">
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-outline-secondary btn-sm" data-dismiss="modal">Đóng</button>
                            <button type="button" class="btn btn-warning btn-sm" id="refresh_save_block_btn" style="margin-left: 0.5rem !important;">Làm mới</button>
                            <button type="button" class="btn btn-primary btn-sm" id="save_block_btn" style="margin-left: 0.5rem !important;">Lưu</button>
                        </div>
                    </div>
                </div>
            </div>

            {{-- Modal Tạo mới Tầng --}}
            <div class="modal fade" id="modal_create_floor" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Tạo mới Tầng</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form action="" id="form_create_floor">
                                <div class="row">
                                    <div class="col-3">
                                        <label for="floor_name_create" class="col-form-label float-right">Số Tầng</label>
                                    </div>
                                    <div class="col-9">
                                        <input type="number" name="" id="floor_name_create" class="form-control form-control-sm">
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-outline-secondary btn-sm" data-dismiss="modal">Đóng</button>
                            <button type="button" class="btn btn-warning btn-sm" id="refresh_save_floor_btn" style="margin-left: 0.5rem !important;">Làm mới</button>
                            <button type="button" class="btn btn-primary btn-sm" id="save_floor_btn" style="margin-left: 0.5rem !important;">Lưu</button>
                        </div>
                    </div>
                </div>
            </div>

            {{-- Modal Tạo mới Căn hộ --}}
            <div class="modal fade" id="modal_create_room" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Tạo mới Căn hộ</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form action="" id="form_create_room">
                                <div class="row">
                                    <div class="col-3">
                                        <label for="room_name_create" class="col-form-label float-right">Tên Căn hộ</label>
                                    </div>
                                    <div class="col-9">
                                        <input type="text" name="" id="room_name_create" class="form-control form-control-sm">
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-outline-secondary btn-sm" data-dismiss="modal">Đóng</button>
                            <button type="button" class="btn btn-warning btn-sm" id="refresh_save_room_btn" style="margin-left: 0.5rem !important;">Làm mới</button>
                            <button type="button" class="btn btn-primary btn-sm" id="save_room_btn" style="margin-left: 0.5rem !important;">Lưu</button>
                        </div>
                    </div>
                </div>
            </div>

            {{-- Modal Tạo mới Đối tượng --}}
            <div class="modal fade" id="modal_create_resident_object" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Tạo mới Đối tượng</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form action="" id="form_create_resident_object">
                                <div class="row">
                                    <div class="col-3">
                                        <label for="resident_object_name_create" class="col-form-label float-right">Loại đối tượng</label>
                                    </div>
                                    <div class="col-9">
                                        <input type="text" name="" id="resident_object_name_create" class="form-control form-control-sm">
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-outline-secondary btn-sm" data-dismiss="modal">Đóng</button>
                            <button type="button" class="btn btn-warning btn-sm" id="refresh_save_resident_object_btn" style="margin-left: 0.5rem !important;">Làm mới</button>
                            <button type="button" class="btn btn-primary btn-sm" id="save_resident_object_btn" style="margin-left: 0.5rem !important;">Lưu</button>
                        </div>
                    </div>
                </div>
            </div>

            {{-- Modal Chỉnh sửa --}}
            <div class="modal fade" id="modal_edit_household" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Chỉnh sửa</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form action="" id="form_edit_household">
                                <input type="number" id="room_id">
                                <input type="number" id="household_id">
                                <div class="row">
                                    <div class="col-3">
                                        <label for="household_fullname_edit" class="col-form-label float-right">Tên khách hàng</label>
                                    </div>
                                    <div class="col-9">
                                        <input type="text" name="household_fullname_edit" id="household_fullname_edit" class="form-control form-control-sm">
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_apartment_edit" class="col-form-label float-right">Tên chung cư</label>
                                    </div>
                                    <div class="col-9">
                                        <input list="list_apartment_edit" name="household_apartment_edit" id="household_apartment_edit" class="form-control form-control-sm">
                                        <datalist id="list_apartment_edit">
                                            <option></option>
                                        </datalist>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_block_edit" class="col-form-label float-right">Nhà</label>
                                    </div>
                                    <div class="col-8">
                                        <input list="list_block_edit" name="household_block_edit" id="household_block_edit" class="form-control form-control-sm">
                                        <datalist id="list_block_edit">
                                            <option></option>
                                        </datalist>
                                    </div>
                                    <div class="col-1 p-0">
                                        <button type="button" class="btn btn-outline-info btn-sm" id="create_block_btn">
                                            <i class="fa-solid fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_floor_edit" class="col-form-label float-right">Tầng</label>
                                    </div>
                                    <div class="col-8">
                                        <input list="list_floor_edit" name="household_floor_edit" id="household_floor_edit" class="form-control form-control-sm">
                                        <datalist id="list_floor_edit">
                                            <option></option>
                                        </datalist>
                                    </div>
                                    <div class="col-1 p-0">
                                        <button type="button" class="btn btn-outline-info btn-sm" id="create_floor_btn">
                                            <i class="fa-solid fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_room_edit" class="col-form-label float-right">Căn hộ</label>
                                    </div>
                                    <div class="col-8">
                                        <input list="list_room_edit" name="household_room_edit" id="household_room_edit" class="form-control form-control-sm">
                                        <datalist id="list_room_edit">
                                            <option></option>
                                        </datalist>
                                    </div>
                                    <div class="col-1 p-0">
                                        <button type="button" class="btn btn-outline-info btn-sm" id="create_room_btn">
                                            <i class="fa-solid fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_resident_object_edit" class="col-form-label float-right">Đối tượng</label>
                                    </div>
                                    <div class="col-8">
                                        <input list="list_resident_object_edit" name="household_resident_object_edit" id="household_resident_object_edit" class="form-control form-control-sm">
                                        <datalist id="list_resident_object_edit">
                                            <option></option>
                                        </datalist>
                                    </div>
                                    <div class="col-1 p-0">
                                        <button type="button" class="btn btn-outline-info btn-sm" id="create_resident_object_btn">
                                            <i class="fa-solid fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_price_edit" class="col-form-label float-right">Đơn giá</label>
                                    </div>
                                    <div class="col-9">
                                        <input type="number" name="household_price_edit" id="household_price_edit" class="form-control form-control-sm">
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_exemption_edit" class="col-form-label float-right">Miễn giảm</label>
                                    </div>
                                    <div class="col-9">
                                        <input list="list_exemption_edit" name="household_exemption_edit" id="household_exemption_edit" class="form-control form-control-sm">
                                        <datalist id="list_exemption_edit">
                                            <option></option>
                                        </datalist>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-3">
                                        <label for="household_contract_signing_date_edit" class="col-form-label float-right">Ngày ký HĐ</label>
                                    </div>
                                    <div class="col-9">
                                        <input type="date" name="household_contract_signing_date_edit" id="household_contract_signing_date_edit" class="form-control form-control-sm">
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-outline-secondary btn-sm" data-dismiss="modal">Đóng</button>
                            <button type="button" class="btn btn-warning btn-sm" id="refresh_update_household_btn" style="margin-left: 0.5rem !important;">Làm mới</button>
                            <button type="button" class="btn btn-success btn-sm" id="update_household_btn" style="margin-left: 0.5rem !important;">Cập nhật</button>
                        </div>
                    </div>
                </div>
            </div>

            {{-- Modal Xóa --}}
            <div class="modal fade" id="modal_delete_household" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Xác nhận</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <span>Chắc chắn muốn xóa Hộ dân này?</span>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-outline-secondary btn-sm" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-danger btn-sm" style="margin-left: 0.5rem !important;">Xác nhận xóa</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@endsection

@section('script')
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="{{ asset('./js/index.js') }}"></script>
<script>
    $(document).ready(function() {
        function validateHousehold(name, room, price, date, btn) {
            let validateFullname = validateField(name, btn, 'input', 'Vui lòng nhập tên Khách hàng');
            let validateRoom = validateField(room, btn, 'change', 'Vui lòng chọn Căn hộ');
            let validatePrice = validateField(price, btn, 'input', 'Vui lòng nhập Đơn giá');
            let validateContractSigningDate = validateField(date, btn, 'input', 'Vui lòng chọn Ngày ký HĐ');
            if(!validateFullname || !validateRoom || !validatePrice || !validateContractSigningDate) return false;
            return true;
        }

        $(document).off('click', '#create_household_btn').on('click', '#create_household_btn', function(e) {
            e.preventDefault();
            $('#modal_create_household').modal('show');

            $(document).off('shown.bs.modal', '#modal_create_household').on('shown.bs.modal', '#modal_create_household', function() {
                $('#household_apartment_create').val('');
                $.ajax({
                    type: "GET",
                    url: "{{ route('get.list.apartment') }}",
                    success: function (res) {
                        if(res.status == 200) {
                            listDatalistName($('#list_apartment_create'), res.apartments);
                        }
                    }
                });

                $('#household_resident_object_create').val('');
                $.ajax({
                    type: "GET",
                    url: "{{ route('get.list.resident_object') }}",
                    success: function (res) {
                        if(res.status == 200) {
                            $('#list_resident_object_create').html('');
                            $.each(res.residentObjects, function(key, value) {
                                $('#list_resident_object_create').append('\
                                    <option>'+ value.title +'</option>\
                                ');
                            });
                        }
                    }
                });
                
                $('#household_exemption_create').val('');
                $.ajax({
                    type: "GET",
                    url: "{{ route('get.list.exemption') }}",
                    success: function (res) {
                        if(res.status == 200) {
                            $('#list_exemption_create').html('');
                            $.each(res.exemptions, function(key, value) {
                                $('#list_exemption_create').append('\
                                    <option>'+ value.exemption +'%</option>\
                                ');
                            });
                        }
                    }
                });
                
                let apartmentName, blockName, floorName, roomName;
                $(document).off('change', 'input[name="household_apartment_create"]').on('change', 'input[name="household_apartment_create"]', function() {
                    $('#household_block_create').val('');
                    $('#household_floor_create').val('');
                    $('#household_room_create').val('');
                    apartmentName = $(this).val();
                    $.ajax({
                        type: "GET",
                        url: "{{ route('get.block.from.apartment') }}",
                        data: {
                            apartmentName: apartmentName != null ? apartmentName : '',
                        },
                        success: function (res) {
                            if(res.status == 200) {
                                $('#list_block_create').html('');
                                $('#list_floor_create').html('');
                                $('#list_room_create').html('');
                                $.each(res.blocks, function(key, value) {
                                    $('#list_block_create').append('\
                                        <option>'+ value.name +'</option>\
                                    ');
                                });
                            }
                        }
                    });
                });

                $(document).off('change', 'input[name="household_block_create"]').on('change', 'input[name="household_block_create"]', function() {
                    $('#household_floor_create').val('');
                    $('#household_room_create').val('');
                    blockName = $(this).val();
                    $.ajax({
                        type: "GET",
                        url: "{{ route('get.floor.from.block') }}",
                        data: {
                            apartmentName: apartmentName,
                            blockName: blockName,
                        },
                        success: function (res) {
                            if(res.status == 200) {
                                $('#list_floor_create').html('');
                                $('#list_room_create').html('');
                                $.each(res.floors, function(key, value) {
                                    $('#list_floor_create').append('\
                                        <option>'+ value.name +'</option>\
                                    ');
                                });
                            }
                        }
                    });
                });

                $(document).off('change', 'input[name="household_floor_create"]').on('change', 'input[name="household_floor_create"]', function() {
                    $('#household_room_create').val('');
                    floorName = $(this).val();
                    $.ajax({
                        type: "GET",
                        url: "{{ route('get.room.from.floor') }}",
                        data: {
                            apartmentName: apartmentName,
                            blockName: blockName,
                            floorName: floorName,
                        },
                        success: function (res) {
                            if(res.status == 200) {
                                $('#list_room_create').html('');
                                $.each(res.rooms, function(key, value) {
                                    $('#list_room_create').append('\
                                        <option>'+ value.name +'</option>\
                                    ');
                                });
                            }
                        }
                    });
                });

                $(document).off('change', 'input[name="household_room_create"]').on('change', 'input[name="household_room_create"]', function() {
                    roomName = $(this).val();
                    $('#room_id').val('');
                    $.ajax({
                        type: "GET",
                        url: "{{ route('get.id.from.room_name') }}",
                        data: {
                            apartmentName: apartmentName,
                            blockName: blockName,
                            floorName: floorName,
                            roomName: roomName,
                        },
                        success: function (res) {
                            $('#room_id').val(res.roomId);
                        }
                    });
                });
            });

            $(document).off('click', '#refresh_save_household_btn').on('click', '#refresh_save_household_btn', function(e) {
                e.preventDefault();
                $('#form_create_household').find(':input').val('');
                $('#form_create_household').find('datalist:not(#list_apartment_create, #list_resident_object_create, #list_exemption_create)').html('');
            });

            store_3_1('#modal_create_household', '#modal_create_block', '#form_create_block', '#create_block_btn', '#refresh_save_block_btn', '#save_block_btn', '#block_name_create', "{{ route('apartment.store.block') }}", "{{ csrf_token() }}", '#refresh_input_search_btn', 'tên Nhà');
            store_3_1('#modal_create_household', '#modal_create_floor', '#form_create_floor', '#create_floor_btn', '#refresh_save_floor_btn', '#save_floor_btn', '#floor_name_create', "{{ route('apartment.store.floor') }}", "{{ csrf_token() }}", '#refresh_input_search_btn', 'số Tầng');
            store_3_1('#modal_create_household', '#modal_create_room', '#form_create_room', '#create_room_btn', '#refresh_save_room_btn', '#save_room_btn', '#room_name_create', "{{ route('apartment.store.room') }}", "{{ csrf_token() }}", '#refresh_input_search_btn', 'tên Căn hộ');
            store_3_1('#modal_create_household', '#modal_create_resident_object', '#form_create_resident_object', '#create_resident_object_btn', '#refresh_save_resident_object_btn', '#save_resident_object_btn', '#resident_object_name_create', "{{ route('apartment.store.resident_object') }}", "{{ csrf_token() }}", '#refresh_input_search_btn', 'loại Đối tượng');

            $(document).prop('disabled', false).off('click', '#save_household_btn').on('click', '#save_household_btn', function(e) {
                e.preventDefault();
                let householdName = $('#household_fullname_create');
                let roomId = $('#room_id');
                let residentObject = $('#household_resident_object_create');
                let price = $('#household_price_create');
                let contractSigningDate = $('#household_contract_signing_date_create');
                let exemption = $('#household_exemption_create');
                let priceAfterEx = parseInt(price.val()) - (parseInt(price.val()) * parseInt(exemption.val() == '' ? 0 : exemption.val().split('%')[0]) / 100);
                
                if(!validateHousehold('#household_fullname_create', '#household_room_create', '#household_price_create', '#household_contract_signing_date_create', $(this)))
                    return;
                $(this).prop('disabled', true);
                $.ajax({
                    type: "POST",
                    url: "{{ route('household.store') }}",
                    data: {
                        householdName: householdName.val(),
                        roomId: roomId.val(),
                        residentObject: residentObject.val(),
                        price: price.val(),
                        exemption: exemption.val().split('%')[0],
                        priceAfterEx: priceAfterEx,
                        contractSigningDate: contractSigningDate.val(),
                        _token: "{{ csrf_token() }}",
                    },
                    success: function (res) {
                        if(res.status == 200) {
                            alert(res.message);
                            $('#modal_create_household').modal('hide');
                            $('#save_household_btn').prop('disabled', false);
                            $('#refresh_input_search_btn').click();

                        }
                        if(res.status == 400 || res.status == 401 || res.status == 402 || res.status == 403 || res.status == 404) {
                            alert(res.message);
                            $('#save_household_btn').prop('disabled', false);
                        }
                    }
                });
            });

            $(document).off('hidden.bs.modal', '#modal_create_household').on('hidden.bs.modal', '#modal_create_household', function() {
                $('#form_create_household').find(':input').val('');
                $('#form_create_household').find('datalist:not(#list_apartment_create, #list_resident_object_create, #list_exemption_create)').html('');
                $('#form_create_household').find('.border.border-danger').removeClass('border border-danger');
                $('#form_create_household').find('.text-danger').remove();
            });
        });

        $(document).off('click', '#edit_household_btn').on('click', '#edit_household_btn', function(e) {
            e.preventDefault();
            $('#modal_edit_household').modal('show');
            let householdName = $('#household_fullname_edit');
            let roomId = $('#room_id');
            let residentObject = $('#household_resident_object_edit');
            let price = $('#household_price_edit');
            let contractSigningDate = $('#household_contract_signing_date_edit');
            let exemption = $('#household_exemption_edit');
            let priceAfterEx = parseInt(price.val()) - (parseInt(price.val()) * parseInt(exemption.val() == '' ? 0 : exemption.val().split('%')[0]) / 100);
            let id = $(this).val();
            let url = "{{ route('household.edit', ':id') }}";
            url = url.replace(':id', id);

            $(document).off('shown.bs.modal', '#modal_edit_household').on('shown.bs.modal', '#modal_edit_household', function() {
                $.ajax({
                    type: "GET",
                    url: url,
                    success: function (res) {
                        if(res.status == 200) {
                            $('#household_id').val(res.household.id);
                            householdName.val(res.household.fullname);
                            listDatalistName($('#list_apartment_edit'), res.apartments);
                            $('#household_apartment_edit').val(res.apartmentName);
                            listDatalistName($('#list_block_edit'), res.blocks);
                            $('#household_block_edit').val(res.blockName);
                            listDatalistName($('#list_floor_edit'), res.floors);
                            $('#household_floor_edit').val(res.floorName);
                            listDatalistName($('#list_room_edit'), res.rooms);
                            $('#household_room_edit').val(res.roomName);
                            residentObject.val(res.residentObject);
                            price.val(res.price);
                            exemption.val(res.exemption + '%');
                            contractSigningDate.val(res.contractSigningDate);
                            // name.val(res.apartment.name);
                            // $('#apartment_id_edit').val(res.apartment.id);
                            // listCbbName($('#list_apartment_edit'), res.households);
                            // if(res.blockOfApartment != null) {
                            //     let listBlock = $('#list_block_edit > option');
                            //     $.each(res.blockOfApartment, function(key, value) {
                            //         listBlock.each(function() {
                            //             if($(this).text() == value.name) {
                            //                 $(this).prop('selected', true);
                            //             }
                            //         });
                            //     });
                            // }
                        }
                    }
                });

                $(document).off('change', 'input[name="household_apartment_edit"]').on('change', 'input[name="household_apartment_edit"]', function() {
                });
            });
        });
    });
</script>
@endsection
