<?php

namespace App\Http\Controllers\Admin_12345;

use Illuminate\Http\Request;
use App\Http\Controllers\Controller;
use Session;
use Auth;
use App\Repositories\AccountRepository;
use App\Repositories\AccountRoomRepository;
use App\Repositories\ApartmentRepository;
use App\Repositories\ImageRepository;
use App\Repositories\MonthRepository;
use App\Repositories\PolicyRepository;
use App\Repositories\RoomRepository;
use App\Repositories\TypePriceRepository;
use App\Repositories\UserRepository;
use App\Repositories\YearRepository;
use App\Repositories\BlockRepository;
use App\Repositories\HouseholdRepository;
use App\Repositories\HouseholdRoomRepository;

class BlockController extends Controller
{

    protected $accountRepository;
    protected $accountRoomRepository;
    protected $apartmentRepository;
    protected $imageRepository;
    protected $monthRepository;
    protected $policyRepository;
    protected $typePriceRepository;
    protected $userRepository;
    protected $roomRepository;
    protected $yearRepository;
    protected $blockRepository;
    protected $householdRepository;
    protected $householdRoomRepository;
    protected $url = '';

    public function __construct(AccountRepository $accountRepository ,
                                AccountRoomRepository $accountRoomRepository ,
                                ApartmentRepository $apartmentRepository ,
                                ImageRepository $imageRepository ,
                                MonthRepository $monthRepository ,
                                PolicyRepository $policyRepository ,
                                TypePriceRepository $typePriceRepository ,
                                UserRepository $userRepository ,
                                RoomRepository $roomRepository ,
                                YearRepository $yearRepository,
                                BlockRepository $blockRepository,
                                HouseholdRepository $householdRepository,
                                HouseholdRoomRepository $householdRoomRepository,
                                Request $request ) {

        $this->accountRepository = $accountRepository;
        $this->accountRoomRepository = $accountRoomRepository;
        $this->apartmentRepository = $apartmentRepository;
        $this->imageRepository = $imageRepository;
        $this->monthRepository = $monthRepository;
        $this->policyRepository = $policyRepository;
        $this->typePriceRepository = $typePriceRepository;
        $this->userRepository = $userRepository;
        $this->roomRepository = $roomRepository;
        $this->yearRepository = $yearRepository;
        $this->blockRepository = $blockRepository;
        $this->householdRepository = $householdRepository;
        $this->householdRoomRepository = $householdRoomRepository;

        if (isset($request->url) && $request->url != null) {

            $this->url = $request->url;

        }
    }

    /**
     * Display a listing of the resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function index()
    {
        //
    }

    /**
     * Show the form for creating a new resource.
     *
     * @return \Illuminate\Http\Response
     */
    public function create()
    {
        //
    }

    /**
     * Store a newly created resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return \Illuminate\Http\Response
     */
    public function store(Request $request)
    {
        //
    }

    /**
     * Display the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function show($id)
    {
        //
    }

    /**
     * Show the form for editing the specified resource.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function edit($id)
    {
        //
    }

    /**
     * Update the specified resource in storage.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function update(Request $request, $id)
    {
        //
    }

    /**
     * Remove the specified resource from storage.
     *
     * @param  int  $id
     * @return \Illuminate\Http\Response
     */
    public function destroy($id)
    {
        //
    }

    public function getBlockByApartmentID(Request $request) {

        $name = $request->name;

        $apartment_id = 0;

        $apartment = $this->apartmentRepository->getApartmentByName($name);


        if ($apartment) {

            $apartment_id = $apartment->id;

        }

        $blocks = $this->blockRepository->getBlockByApartmentId($apartment_id);

        return view('admins.debt-control.ajax-room-by-apartment')->with([

            'data' => $blocks,
            'type' => 'blocks'

        ]);

    }
}
