<?php

namespace App\Repositories;

use App\Models_12345\DebtControlGeneral;
use Illuminate\Http\Request;
use App\Http\Requests\RequestResetPass;

class DebtControlRepository extends AbstractRepository
{
    public function getModel()
    {
        return DebtControlGeneral::class;
    }

    public function getListByParams($arr_household_room_id, $month_id, $year_id, $params) {

        $data = $this->model->select()
            ->where('month_id', $month_id)
            ->where('year_id', $year_id);

        if (!empty($arr_household_room_id)) {

            $data = $data->whereIn('household_room_id', $arr_household_room_id);

        }

        if (!empty($params['type_price'])) {

            $type_prices = $params['type_price'];

            $constants = function ($query) use ($type_prices) {

                if (!empty($type_prices)) {
                    $query->whereIn('type_price_id', $type_prices);
                }

            };

            $data->whereHas('debtControlDetail', $constants);
            $data->with([
                'debtControlDetail' => $constants
            ]);

        }


        return $data->distinct()->paginate(20);

    }

    public function getListByArrID($arr_id) {

        return $this->model->whereIn('id', $arr_id)->get();

    }
}
